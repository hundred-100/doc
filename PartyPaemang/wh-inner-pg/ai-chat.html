<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <style>
    .chat-content {
      height: 350px;
      overflow-y: scroll;
    }

    .line {
      margin-top: 10px;
      display: flex;
    }

    .chat-box {
      background: rgb(224, 224, 224);
      padding: 5px;
      max-width: 200px;
    }

    .mine {
      background: rgb(228, 231, 215);
      margin-left: auto;
      margin-right: 5vw;
    }
  </style>
  <div class="chat-content">
    <div class="line">
      <span class="chat-box">Hello?</span>
    </div>
    <div class="line">
      <span class="chat-box mine">Hello!</span>
    </div>
  </div>
  <input class="chat-box" id="input">
  <p>Enter to send message.</p>

  <script type="module">
    import { Configuration, OpenAIApi } from 'https://cdn.skypack.dev/openai';

    document.querySelector('#input').addEventListener('keydown', function (event) {
      if (event.keyCode == 13) {
        var template = `<div class="line">
        <span class="chat-box mine">${document.querySelector('#input').value}</span>
      </div>`
        document.querySelector('.chat-content').insertAdjacentHTML('beforeend', template);



        const configuration = new Configuration({
          apiKey: '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',
        });
        const openai = new OpenAIApi(configuration);

        openai.createCompletion({
          model: "text-davinci-002",
          prompt: document.querySelector('#input').value,
          temperature: 0.7,
          max_tokens: 256,
          top_p: 1,
          frequency_penalty: 0,
          presence_penalty: 0,
        }).then((result) => {
          console.log(result.data.choices[0].text)
          var template = `<div class="line">
          <span class="chat-box">${result.data.choices[0].text}</span>
        </div>`
          document.querySelector('.chat-content').insertAdjacentHTML('beforeend', template);
        })
        document.querySelector('#input').value = null;
      }
    })
  </script>

</body>

</html>